name: Build firmware - All Dagoma variants

on:
  pull_request:
    branches:
      - DE200-2.1.x
    paths:
      - '.github/workflows/build_*.yaml'
      - 'Marlin/**'
  push:
    branches:
      - DE200-2.1.x
    paths:
      - '.github/workflows/build_*.yaml'
      - 'Marlin/**'
  release:
    types:
      - published
  workflow_dispatch:

jobs:
  build_en:
    strategy:
      fail-fast: false
      matrix:
        lang:
          - en
        screen:   [Std]
        extruder: [Std, Extruder+, Bicolor]
        zscrews:  [Std, Expert]
        size:     [Std, xl]
        warping:  [Std, Bed]
        thermist: [White, Black]
        pinout:   [Std, MKS]
        head:     [Std, z122]
    permissions:
      contents: write
    name: "Build: ${{ matrix.lang }}"
    uses: ./.github/workflows/build_single.yaml
    with:
      lang:     ${{ matrix.lang }}
      screen:   ${{ matrix.screen }}
      extruder: ${{ matrix.extruder }}
      zscrews:  ${{ matrix.zscrews }}
      size:     ${{ matrix.size }}
      warping:  ${{ matrix.warping }}
      thermist: ${{ matrix.thermist }}
      pinout:   ${{ matrix.pinout }}
      head:     ${{ matrix.head }}
    secrets: inherit

  build_noscreen:
    strategy:
      fail-fast: false
      matrix:
        lang:
          - en
        screen:   ["-"]
        extruder: [Std]
        zscrews:  [Std]
        size:     [Std]
        warping:  [Std, Bed]
        thermist: [White, Black]
        pinout:   [Std]
        head:     [Std]
    permissions:
      contents: write
    name: "Build: ${{ matrix.lang }}"
    uses: ./.github/workflows/build_single.yaml
    with:
      lang:     ${{ matrix.lang }}
      screen:   ${{ matrix.screen }}
      extruder: ${{ matrix.extruder }}
      zscrews:  ${{ matrix.zscrews }}
      size:     ${{ matrix.size }}
      warping:  ${{ matrix.warping }}
      thermist: ${{ matrix.thermist }}
      pinout:   ${{ matrix.pinout }}
      head:     ${{ matrix.head }}
    secrets: inherit

  build_fr:
    needs: build_en
    strategy:
      fail-fast: false
      matrix:
        lang:
          - fr
        screen:   [Std]
        extruder: [Std, Extruder+, Bicolor]
        zscrews:  [Std, Expert]
        size:     [Std, xl]
        warping:  [Std, Bed]
        thermist: [White, Black]
        pinout:   [Std, MKS]
        head:     [Std, z122]
    permissions:
      contents: write
    name: "Build: ${{ matrix.lang }}"
    uses: ./.github/workflows/build_single.yaml
    with:
      lang:     ${{ matrix.lang }}
      screen:   ${{ matrix.screen }}
      extruder: ${{ matrix.extruder }}
      zscrews:  ${{ matrix.zscrews }}
      size:     ${{ matrix.size }}
      warping:  ${{ matrix.warping }}
      thermist: ${{ matrix.thermist }}
      pinout:   ${{ matrix.pinout }}
      head:     ${{ matrix.head }}
    secrets: inherit

  build_de:
    needs: build_en
    strategy:
      fail-fast: false
      matrix:
        lang:
          - de
        screen:   [Std]
        extruder: [Std, Extruder+, Bicolor]
        zscrews:  [Std, Expert]
        size:     [Std, xl]
        warping:  [Std, Bed]
        thermist: [White, Black]
        pinout:   [Std, MKS]
        head:     [Std, z122]
    permissions:
      contents: write
    name: "Build: ${{ matrix.lang }}"
    uses: ./.github/workflows/build_single.yaml
    with:
      lang:     ${{ matrix.lang }}
      screen:   ${{ matrix.screen }}
      extruder: ${{ matrix.extruder }}
      zscrews:  ${{ matrix.zscrews }}
      size:     ${{ matrix.size }}
      warping:  ${{ matrix.warping }}
      thermist: ${{ matrix.thermist }}
      pinout:   ${{ matrix.pinout }}
      head:     ${{ matrix.head }}
    secrets: inherit
